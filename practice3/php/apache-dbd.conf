# Настройка mod_dbd для подключения к MySQL и перемещение SQL‑запроса в конфиг
DBDriver mysql
DBDParams "host=db port=3306 user=user pass=password dbname=appDB"
# Не создаём минимальные соединения на старте — дождёмся первого запроса
DBDMin 0
DBDKeep 2
DBDMax 20
DBDExptime 300

# Разрешаем query для каталога с приложением — AuthDBDUserPWQuery нельзя в .htaccess
<Directory "/var/www/app_root">
    # SQL возвращает пароль (plain в вашем init.sql) для введённого логина, только если is_admin = 1
    # %s будет заменён на предоставленное имя пользователя
    AuthDBDUserPWQuery "SELECT password FROM users WHERE login = %s AND is_admin = 1"
</Directory>